parameters:
  projectName: ''
  imageName: ''

steps:
- bash: |
    if [ -z "$PROJECT_NAME" ]; then
      echo "##vso[task.logissue type=error;]Missing template parameter \"projectName\""
      echo "##vso[task.complete result=Failed;]"
    fi
    if [ -z "$IMAGE_NAME" ]; then
      echo "##vso[task.logissue type=error;]Missing template parameter \"imageName\""
      echo "##vso[task.complete result=Failed;]"
    fi
  env:
    PROJECT_NAME: ${{ parameters.projectName }}
    IMAGE_NAME: ${{ parameters.imageName }}
  displayName: Check for required parameters in YAML template
- task: Docker@1
  displayName: 'Build ''${{ parameters.imageName }}'' Docker image'
  inputs:
    dockerFile: src/${{ parameters.projectName }}/Dockerfile
    imageName: '${{ parameters.imageName }}:$(Build.BuildId)'
    useDefaultContext: false
    buildContext: src